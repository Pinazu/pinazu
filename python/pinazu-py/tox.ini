[tox]
# Tox configuration for testing across Python versions
envlist = py310, py311, py312, lint, type-check
isolated_build = True

[testenv]
# Default test environment configuration
deps =
    pytest>=6.0
    pytest-asyncio>=0.21.0
    pytest-mock>=3.10.0
    pytest-cov>=4.0.0
    httpx>=0.28.1

commands =
    # Run unit tests by default
    pytest {posargs:tests/ -m "not integration"}

[testenv:unit]
# Run only unit tests (no integration tests)
commands =
    pytest tests/ -m "not integration" --cov=pinazu --cov-report=html --cov-report=term

[testenv:integration]
# Run only integration tests (requires running Pinazu server)
commands =
    pytest tests/ -m "integration" -v

[testenv:all]
# Run all tests including integration
commands =
    pytest tests/ --cov=pinazu --cov-report=html --cov-report=term

[testenv:lint]
# Code linting with ruff
deps =
    ruff>=0.1.0
commands =
    ruff check src/ tests/
    ruff format --check src/ tests/

[testenv:format]
# Code formatting with ruff
deps =
    ruff>=0.1.0
commands =
    ruff format src/ tests/
    ruff check --fix src/ tests/

[testenv:type-check]
# Type checking with mypy
deps =
    mypy>=1.0.0
    types-requests
commands =
    mypy src/pinazu

[testenv:docs]
# Documentation building (if needed in future)
deps =
    sphinx
    sphinx-rtd-theme
commands =
    sphinx-build -b html docs/ docs/_build/html

[pytest]
# Pytest configuration (can also be in pytest.ini)
testpaths = tests
markers =
    unit: Unit tests that don't require external services
    integration: Integration tests that require a running Pinazu server
    slow: Tests that take a long time to run
    network: Tests that require network connectivity